LIBRARY=	libcf

CALFUSEDIR=	${PWD}/../..
SHARED=		-shared -fPIC

# Symbols for include directories
FUSEINCLDIR=	-I${CALFUSEDIR}/include

# Symbols used for compiling
CC=		cc
OPT=		-g -Wall -DCFORTRAN -Dg77Fortran -Df2cFortran
CFLAGS=		${OPT} ${FUSEINCLDIR}

FUSELIBDIR=	-L${CALFUSEDIR}/lib
FUSELIBS=	-lsla
LIBS=		-lc -lm -lnsl -ldl -lgfortran -lcfitsio
LDFLAGS=	

# Symbols used for creating shared libraries

SO=		.so

OBJS=		calfits.o sgp4.o eclipse.o saa.o \
		state_limb.o state_geod.o space_vel.o helio_vel.o \
		geod_mag.o pole_ang.o solar_ang.o lsrd_vel.o lsrk_vel.o \
		month_day.o read_tle.o cf_velang.o \
		set_orbit_parms.o cf_error_msg.o \
		cf_cal_file.o cf_proc_check.o cf_proc_update.o \
		cf_timestamp.o cf_fuv_init.o cf_header_io.o \
		cf_check_digitizer.o cf_nint.o \
		cf_idf_io.o cf_ids_dead_time.o cf_electronics_dead_time.o \
		cf_fifo_dead_time.o cf_apply_dead_time.o \
		cf_thermal_distort.o cf_count_rate_y_distort.o cf_time_xy_distort.o \
		cf_geometric_distort.o cf_pha_x_distort.o \
		cf_active_region.o cf_find_spectra.o cf_identify_channel.o \
		cf_calculate_ycent_motion.o cf_source_aper.o\
		cf_grating_motion.o cf_fpa_position.o cf_read_fpa_pos.o \
		cf_make_mask.o cf_mirror_motion.o \
		cf_satellite_jitter.o cf_calculate_y_centroid.o \
		cf_target_count_rate.o \
		cf_screen_jitter.o cf_screen_limb_angle.o cf_screen_saa.o \
		cf_screen_high_voltage.o cf_screen_burst.o cf_screen_airglow.o \
		cf_screen_bad_pixels.o cf_set_user_gtis.o \
		cf_set_photon_flags.o cf_set_good_time_intervals.o \
		cf_modify_hist_times.o cf_screen_pulse_height.o \
		cf_convert_to_ergs.o cf_extraction_limits.o \
		cf_astigmatism.o cf_dispersion.o cf_doppler_and_heliocentric.o \
		cf_apply_filters.o cf_scale_bkgd.o \
		cf_make_wave_array.o cf_rebin_background.o \
		cf_rebin_probability_array.o cf_optimal_extraction.o \
		cf_write_extracted_spectrum.o cf_standard_or_optimal_extraction.o \
		cf_init_support.o cf_modify_hist_pha.o \
		cf_fes_proc_check.o cf_fes_proc_update.o

all:		${OBJS}
		${CC} ${SHARED} -o ${LIBRARY}${SO} ${OBJS} \
		${FUSELIBDIR} ${FUSELIBS} ${LIBS} ${LDFLAGS}

install:	all
		chmod g+w ${OBJS} ${LIBRARY}${SO}
		/bin/cp -p ${LIBRARY}${SO} ${CALFUSEDIR}/lib/${LIBRARY}${SO}

clean: 
	-	/bin/rm -f *.o ${LIBRARY}${SO} ${LIBRARY}${O}

distclean: 
	-	/bin/rm -f *.o ${LIBRARY}${SO} ${LIBRARY}${O}
		cd ../../lib; /bin/rm -f ${LIBRARY}${SO}

calfits.o: calfits.c
sgp4.o: sgp4.c
eclipse.o: eclipse.c
set_orbit_parms.o: set_orbit_parms.c
saa.o: saa.c
state_limb.o: state_limb.c
state_geod.o: state_geod.c
space_vel.o: space_vel.c
helio_vel.o: helio_vel.c
geod_mag.o: geod_mag.c
pole_ang.o: pole_ang.c
solar_ang.o: solar_ang.c
lsrd_vel.o: lsrd_vel.c
lsrk_vel.o: lsrk_vel.c
month_day.o: month_day.c
read_tle.o: read_tle.c

cf_error_msg.o: cf_error_msg.c
cf_cal_file.o: cf_cal_file.c
cf_fes_proc_check.o: cf_fes_proc_check.c
cf_fes_proc_update.o: cf_fes_proc_update.c
cf_proc_check.o: cf_proc_check.c
cf_proc_update.o: cf_proc_update.c
cf_fuv_init.o: cf_fuv_init.c
cf_velang.o: cf_velang.c
cf_timestamp.o: cf_timestamp.c

cf_header_io.o: cf_header_io.c
cf_check_digitizer.o: cf_check_digitizer.c
cf_nint.o: cf_nint.c
cf_idf_io.o: cf_idf_io.c
cf_ids_dead_time.o: cf_ids_dead_time.c
cf_electronics_dead_time.o: cf_electronics_dead_time.c
cf_fifo_dead_time.o: cf_fifo_dead_time.c
cf_apply_dead_time.o: cf_apply_dead_time.c
cf_thermal_distort.o: cf_thermal_distort.c
cf_count_rate_y_distort.o: cf_count_rate_y_distort.c
cf_time_xy_distort.o : cf_time_xy_distort.c
cf_geometric_distort: cf_geometric_distort.c
cf_pha_x_distort.o: cf_pha_x_distort.c
cf_active_region.o: cf_active_region.c
cf_find_spectra.o: cf_find_spectra.c
cf_identify_channel.o: cf_identify_channel.c
cf_init_support.o: cf_init_support.c
cf_target_count_rate.o: cf_target_count_rate.c
cf_calculate_ycent_motion.o: cf_calculate_ycent_motion.c
cf_source_aper.o: cf_source_aper.c
cf_grating_motion.o: cf_grating_motion.c
cf_fpa_position.o: cf_fpa_position.c
cf_read_fpa_pos.o: cf_read_fpa_pos.c
cf_make_mask.o: cf_make_mask.c
cf_mirror_motion.o: cf_mirror_motion.c
cf_satellite_jitter.o: cf_satellite_jitter.c
cf_calculate_y_centroid.o: cf_calculate_y_centroid.c
cf_screen_airglow.o: cf_screen_airglow.c
cf_screen_bad_pixels.o: cf_screen_bad_pixels.c
cf_screen_jitter.o: cf_screen_jitter.c
cf_screen_limb_angle.o: cf_screen_limb_angle.c
cf_screen_saa.o: cf_screen_saa.c
cf_screen_high_voltage.o: cf_screen_high_voltage.c
cf_screen_burst.o: cf_screen_burst.c
cf_set_user_gtis.o: cf_set_user_gtis.c 
cf_set_photon_flags.o: cf_set_photon_flags.c
cf_set_good_time_intervals.o: cf_set_good_time_intervals.c
cf_modify_hist_pha.o: cf_modify_hist_pha.c
cf_modify_hist_times.o: cf_modify_hist_times.c
cf_screen_pulse_height.o: cf_screen_pulse_height.c
cf_convert_to_ergs.o: cf_convert_to_ergs.c
cf_extraction_limits.o: cf_extraction_limits.c
cf_astigmatism.o: cf_astigmatism.c
cf_dispersion.o: cf_dispersion.c
cf_doppler_and_heliocentric.o: cf_doppler_and_heliocentric.c
cf_apply_filters.o: cf_apply_filters.c
cf_scale_bkgd.o: cf_scale_bkgd.c
cf_make_mask.o: cf_make_mask.c
cf_make_wave_array.o: cf_make_wave_array.c
cf_rebin_background.o: cf_rebin_background.c
cf_rebin_probability_array.o: cf_rebin_probability_array.c
cf_standard_or_optimal_extraction.o: cf_standard_or_optimal_extraction.c
cf_optimal_extraction.o: cf_optimal_extraction.c
cf_write_extracted_spectrum.o: cf_write_extracted_spectrum.c

